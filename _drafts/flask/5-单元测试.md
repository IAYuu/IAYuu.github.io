---
layout: single
title: 单元测试
---
- 准备
  - 创建 `tests` 目录
  - 在 `tests` 目录下创建空 `__init__.py` 文件
  - 在启动文件下设置 `test` 命令
  ```python
  @app.cli.command()
  @click.argument('test_names', nargs=-1)
  def test(test_names):
      """Run the unit tests."""
      import unittest
      if test_names:
          tests = unittest.TestLoader().loadTestsFromNames(test_names)
      else:
          tests = unittest.TestLoader().discover('tests')
      unittest.TextTestRunner(verbosity=2).run(tests)
  ```
- 写单元测试
  - 创建测试环境
  ```python
  def setUp(self):
      self.app = create_app('testing')
      self.app_context = self.app.app_context()
      self.app_context.push()
      db.create_all()
  ```
